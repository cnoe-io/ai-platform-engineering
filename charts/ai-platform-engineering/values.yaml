tags:
  basic: false
  complete: false
  backstage-agent-forge: false
  caipe-ui: false
  agent-argocd: false
  agent-aws: false
  agent-backstage: false
  agent-confluence: false
  agent-github: false
  agent-gitlab: false
  agent-jira: false
  agent-komodor: false
  agent-pagerduty: false
  agent-slack: false
  agent-splunk: false
  agent-webex: false
  rag-stack: false

# Global configuration shared across all subcharts
global:
  createLlmSecret: false # if true, llm secret will be created by the parent chart. Otherwise, expect existing llm secret
  llmSecrets:
    create: false # do not create llm secret in subcharts (use global or existing llm secret)
    secretName: "llm-secret"
  externalSecrets:
    enabled: false
    apiVersion: "v1beta1"  # API version for ExternalSecret resources. Options: "v1" or "v1beta1". Defaults to "v1beta1" if not specified.
  slim:
    enabled: false
    endpoint: "http://ai-platform-engineering-slim:46357"
    transport: "slim"

  # RAG Stack configuration
  rag:
    enableGraphRag: true

  metrics:
    enabled: false

  agentgateway:
    enabled: false

  caipeUi:
    enabled: false

# ServiceMonitor for scraping all ai-platform-engineering components
# For agent metrics endpoints, use global.metrics.enabled above
metrics:
  # Path for metrics endpoint
  path: "/metrics"
  # ServiceMonitor configuration for Prometheus Operator
  serviceMonitor:
    # Enable ServiceMonitor for automatic Prometheus scraping
    # This creates ONE ServiceMonitor that scrapes ALL ai-platform-engineering services
    enabled: false
    # Scrape interval
    interval: "30s"
    # Scrape timeout
    scrapeTimeout: "10s"
    # Additional labels for the ServiceMonitor (e.g., to match Prometheus selector)
    # Example: labels: { release: prometheus }
    labels: {}
    # Additional annotations for the ServiceMonitor
    annotations: {}
    # Relabelings for metrics
    relabelings: []
    # Metric relabelings
    metricRelabelings: []
  grafanaDashboard:
    enabled: true
    # Labels for Grafana sidecar dashboard discovery
    # Override to match your Grafana sidecar configuration (e.g., grafana_dashboard: "local")
    labels:
      grafana_dashboard: "1"

# Extra Kubernetes resources to deploy
extraDeploy: []

# Prompt Configuration
# Choose between predefined prompt configurations or provide your own custom configuration
#
# Option 1: Use a predefined prompt configuration type
# promptConfigType: "default"       # Uses data/prompt_config.yaml (standard orchestrator)
# promptConfigType: "deep_agent"    # Uses data/prompt_config.deep_agent.yaml (strict zero-hallucination mode)
#
# Option 2: Provide custom prompt configuration (overrides promptConfigType)
# promptConfig: |
#   agent_name: "My Custom Agent"
#   system_prompt_template: |
#     ...
#
promptConfigType: "default"  # Options: "default" or "deep_agent"
promptConfig: ""              # Custom prompt config (overrides promptConfigType if set)

ragPromptConfig: ""           # Custom RAG prompt config (overrides default if set)

######### Supervisor agent configuration #########
supervisor-agent:
  nameOverride: "supervisor-agent"
  image:
    repository: "ghcr.io/cnoe-io/ai-platform-engineering"
    # tag defaults to .Chart.AppVersion when not specified
    tag: ""
    pullPolicy: "Always"
    args: ["platform-engineer"]
  env:
    EXTERNAL_URL: "http://localhost:8000"  # Agent url for the client. NOTE: this will be user applicaiton specific
    SKIP_AGENT_CONNECTIVITY_CHECK: "false"
    AGENT_CONNECTIVITY_ENABLE_BACKGROUND: "true"
    USE_STRUCTURED_RESPONSE: "false" # Set to "true" to enforce agent to always use structured response format as the final output
  multiAgentConfig:
    protocol: "a2a"
    port: "8000"

######### Sub-agent configurations #########
# Agent configurations using aliases from Chart.yaml
agent-argocd:
  nameOverride: "agent-argocd"
  image:
    repository: "ghcr.io/cnoe-io/agent-argocd"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-argocd"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-backstage:
  nameOverride: "agent-backstage"
  image:
    repository: "ghcr.io/cnoe-io/agent-backstage"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-backstage"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-confluence:
  nameOverride: "agent-confluence"
  image:
    repository: "ghcr.io/cnoe-io/agent-confluence"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/sooperset/mcp-atlassian"
      tag: "latest"
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000
    env:
      TRANSPORT: "streamable-http"

agent-github:
  nameOverride: "agent-github"
  image:
    repository: "ghcr.io/cnoe-io/agent-github"
    pullPolicy: "Always"
  mcp:
    useRemoteMcpServer: true

agent-gitlab:
  nameOverride: "agent-gitlab"
  image:
    repository: "ghcr.io/cnoe-io/agent-gitlab"
    pullPolicy: "Always"
  env:
    GIT_AUTHOR_NAME: "AI Agent"
    GIT_AUTHOR_EMAIL: "ai-agent@cnoe.io"
    GIT_COMMITTER_NAME: "AI Agent"
    GIT_COMMITTER_EMAIL: "ai-agent@cnoe.io"
  mcp:
    image:
      repository: "zereight050/gitlab-mcp"
      tag: "latest"
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000
    env:
      STREAMABLE_HTTP: "true"
      HOST: "0.0.0.0"
      PORT: "8000"
      MAX_SESSIONS: "1000"
      MAX_REQUESTS_PER_MINUTE: "60"
      USE_PIPELINE: "true"
      # GITLAB_API_URL and GITLAB_PERSONAL_ACCESS_TOKEN should come from agentSecrets
      # Option 1: Simple read-only mode (blocks all write operations)
      GITLAB_READ_ONLY_MODE: "true"
      # Option 2: Fine-grained control via regex (uncomment and customize)
      # Tool filtering via regex. Uses ^ for prefix matching.
      # Example patterns:
      #
      # READ-ONLY - blocks all write operations:
      #   ^(delete_|remove_|create_|fork_|new_|update_|edit_|merge_|push_|publish_|retry_|cancel_|play_|promote_|upload_|resolve_|bulk_)|^(execute_graphql)$
      #
      # ALLOW CREATE - blocks delete/update:
      #   ^(delete_|remove_|update_|edit_|merge_|push_|publish_|retry_|cancel_|play_|promote_|upload_|resolve_|bulk_)|^(execute_graphql)$
      #
      # ALLOW UPDATE - blocks delete/create:
      #   ^(delete_|remove_|create_|fork_|new_)|^(execute_graphql)$
      #
      # ALLOW CREATE + UPDATE - blocks only delete:
      #   ^(delete_|remove_)|^(execute_graphql)$
      #
      # To block specific tools, add them as exact matches: |^(tool1|tool2)$
      # Example: ...|^(execute_graphql|approve_merge_request|unapprove_merge_request)$
      #
      # Note: execute_graphql is always blocked as it bypasses prefix-based permission controls
      #
      # GITLAB_DENIED_TOOLS_REGEX: "^(delete_|remove_|create_|fork_|new_|update_|edit_|merge_|push_|publish_|retry_|cancel_|play_|promote_|upload_|resolve_|bulk_)|^(execute_graphql)$"

agent-jira:
  nameOverride: "agent-jira"
  image:
    repository: "ghcr.io/cnoe-io/agent-jira"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-jira"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-pagerduty:
  nameOverride: "agent-pagerduty"
  image:
    repository: "ghcr.io/cnoe-io/agent-pagerduty"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-pagerduty"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-slack:
  nameOverride: "agent-slack"
  image:
    repository: "ghcr.io/cnoe-io/agent-slack"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-slack"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-aws:
  nameOverride: "agent-aws"
  image:
    repository: "ghcr.io/cnoe-io/agent-aws"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-aws"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-splunk:
  nameOverride: "agent-splunk"
  image:
    repository: "ghcr.io/cnoe-io/agent-splunk"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-splunk"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-webex:
  nameOverride: "agent-webex"
  image:
    repository: "ghcr.io/cnoe-io/agent-webex"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-webex"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

agent-komodor:
  nameOverride: "agent-komodor"
  image:
    repository: "ghcr.io/cnoe-io/agent-komodor"
    pullPolicy: "Always"
  mcp:
    image:
      repository: "ghcr.io/cnoe-io/mcp-komodor"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"
    mode: "http" # Options: stdio, http
    port: 8000

######### Backstage plugin agent forge configuration #########
backstage-plugin-agent-forge:
  nameOverride: "backstage-plugin-agent-forge"
  image:
    repository: "ghcr.io/cnoe-io/backstage-plugin-agent-forge"
    # tag defaults to .Chart.AppVersion when not specified
    tag: ""
    pullPolicy: "Always"
  service:
    ports:
      - name: http
        port: 3000
        protocol: TCP
      - name: backend
        port: 7007
        protocol: TCP

######### CAIPE UI configuration #########
caipe-ui:
  nameOverride: "caipe-ui"
  image:
    repository: "ghcr.io/cnoe-io/caipe-ui"
    # tag defaults to .Chart.AppVersion when not specified
    tag: ""
    pullPolicy: "Always"
  service:
    port: 3000
  ingress:
    enabled: false
    className: "nginx"
    annotations: {}
    hosts:
      - host: caipe-ui.local
        paths:
          - path: /
            pathType: Prefix
    tls: []
  volumes:
    - name: skill-templates
      configMap:
        name: skill-templates
  volumeMounts:
    - name: skill-templates
      mountPath: /app/data/skills
      readOnly: true
  env:
    # CAIPE Supervisor URL - automatically configured to use the supervisor-agent service
    A2A_BASE_URL: "http://ai-platform-engineering-supervisor-agent:8000"
    # Skills template directory (mounted from ConfigMap)
    SKILLS_DIR: "/app/data/skills"
  # ConfigMap for non-sensitive configuration
  config:
    # Feature flags
    ENABLE_SUBAGENT_CARDS: "true"
    SSO_ENABLED: "true"
    # MongoDB configuration
    MONGODB_DATABASE: "caipe"
    # NextAuth URL (non-sensitive)
    NEXTAUTH_URL: "http://localhost:3000"
    # Node environment
    NODE_ENV: "production"
    # Branding configuration
    TAGLINE: "Multi-Agent Workflow Automation"
    DESCRIPTION: "Where Humans and AI agents collaborate to deliver high quality outcomes."
    APP_NAME: "CAIPE"
    LOGO_URL: "/logo.svg"
    LOGO_STYLE: "default"
    # SPINNER_COLOR: ""
    SHOW_POWERED_BY: "false"
    # Preview mode
    PREVIEW_MODE: "false"
    # Header link URLs (leave empty/commented to hide)
    # DOCS_URL: "https://your-docs-site.com"
    # SOURCE_URL: "https://github.com/your-org/your-repo"
    # Enable Prometheus metrics
    # PROMETHEUS_URL: "http://prometheus-server.monitoring.svc.cluster.local:9090"
  # External Secrets configuration for sensitive data (OIDC credentials, NextAuth secret, MongoDB credentials)
  externalSecrets:
    enabled: false  # Set to true to enable external secrets
    apiVersion: "v1beta1"
    secretStoreRef:
      name: "vault"  # Your secret store name
      kind: "ClusterSecretStore"
    data: []
      # See charts/ai-platform-engineering/charts/caipe-ui/values-external-secrets.yaml for examples

  # MongoDB configuration for CAIPE UI persistence
  mongodb:
    nameOverride: "mongodb"
    enabled: false  # Set to true to enable MongoDB
    image:
      repository: "mongo"
      tag: "7.0"
      pullPolicy: "IfNotPresent"
    service:
      port: 27017
    persistence:
      enabled: true
      storageClass: ""  # Use default storage class or specify one
      size: 10Gi
    auth:
      rootUsername: "admin"
      rootPassword: "changeme"  # CHANGE THIS or use external secrets
      database: "caipe"
    # External Secrets for MongoDB credentials
    externalSecrets:
      enabled: false  # Set to true to use external secrets
      apiVersion: "v1beta1"
      secretStoreRef:
        name: "vault"
        kind: "ClusterSecretStore"
      data: []
        # - secretKey: MONGO_INITDB_ROOT_USERNAME
        #   remoteRef:
        #     key: dev/mongodb
        #     property: username
        # - secretKey: MONGO_INITDB_ROOT_PASSWORD
        #   remoteRef:
        #     key: dev/mongodb
        #     property: password

######### RAG Stack configuration #########
# RAG Stack - Complete stack including web, server, agent, Redis, and Milvus
# Below values are only a subset of the values that are available in the rag-stack chart.
# For more values, please refer to the rag-stack chart values.yaml file.
rag-stack:
######### RAG Stack configuration #########
# RAG Stack - Complete stack including web, server, agent, Redis, and Milvus
# Below values are only a subset of the values that are available in the rag-stack chart.
# For more values, please refer to the rag-stack chart values.yaml file.
rag-stack:

  rag-server:
    enabled: true
    image:
      repository: "ghcr.io/cnoe-io/caipe-rag-server"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"

  agent-rag:
    enabled: true
    image:
      repository: "ghcr.io/cnoe-io/caipe-rag-agent-rag"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"

  agent-ontology:
    enabled: true

  rag-webui:
    enabled: true
    image:
      repository: "ghcr.io/cnoe-io/caipe-rag-webui"
      # tag defaults to .Chart.AppVersion when not specified
      tag: ""
      pullPolicy: "Always"

  neo4j:
    enabled: true

  rag-redis:
    enabled: true
    image:
      repository: "redis"
      tag: "7.2-alpine"
      pullPolicy: IfNotPresent
    persistence:
      enabled: false

  milvus:
    enabled: true
