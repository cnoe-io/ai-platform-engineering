{{- if index .Values "caipe-ui" "enabled" | default false }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: skill-templates
  namespace: {{ .Release.Namespace }}
  labels:
    app.kubernetes.io/name: {{ include "ai-platform-engineering.name" . }}
    app.kubernetes.io/instance: {{ .Release.Name }}
    app.kubernetes.io/version: {{ .Chart.AppVersion | quote }}
    app.kubernetes.io/managed-by: {{ .Release.Service }}
data:
  {{- range $path, $bytes := .Files.Glob "data/skills/**/SKILL.md" }}
  {{- $name := trimSuffix "/SKILL.md" (trimPrefix "data/skills/" $path) }}
  {{ printf "%s--SKILL.md" $name }}: |
{{ $.Files.Get $path | indent 4 }}
  {{- end }}
  {{- range $path, $bytes := .Files.Glob "data/skills/**/metadata.json" }}
  {{- $name := trimSuffix "/metadata.json" (trimPrefix "data/skills/" $path) }}
  {{ printf "%s--metadata.json" $name }}: |
{{ $.Files.Get $path | indent 4 }}
  {{- end }}
{{- end }}
