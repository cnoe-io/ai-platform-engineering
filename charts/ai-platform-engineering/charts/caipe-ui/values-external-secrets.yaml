# Example external secrets configuration for CAIPE UI
# This file demonstrates how to configure external secrets for OIDC and NextAuth
#
# Usage:
#   helm install caipe-ui ./charts/caipe-ui \
#     -f ./charts/caipe-ui/values-external-secrets.yaml \
#     --set externalSecrets.secretStoreRef.name=your-secret-store
#
# Prerequisites:
#   1. External Secrets Operator installed in your cluster
#   2. SecretStore or ClusterSecretStore configured (Vault, AWS Secrets Manager, etc.)
#   3. Secrets stored in your secret store at the specified paths

externalSecrets:
  enabled: true  # Enable external secrets management
  apiVersion: "v1beta1"
  secretStoreRef:
    name: "vault"  # Replace with your secret store name
    kind: "ClusterSecretStore"  # or "SecretStore" for namespace-scoped
  data:
    # NextAuth secret for session encryption
    # Generate with: openssl rand -base64 32
    - secretKey: NEXTAUTH_SECRET
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: dev/caipe-ui  # Path in your secret store
        property: NEXTAUTH_SECRET

    # OIDC Provider configuration for SSO
    - secretKey: OIDC_ISSUER
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: dev/caipe-ui
        property: OIDC_ISSUER

    - secretKey: OIDC_CLIENT_ID
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: dev/caipe-ui
        property: OIDC_CLIENT_ID

    - secretKey: OIDC_CLIENT_SECRET
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: dev/caipe-ui
        property: OIDC_CLIENT_SECRET

# ConfigMap for non-sensitive configuration
config:
  # Feature flags
  NEXT_PUBLIC_ENABLE_SUBAGENT_CARDS: "true"
  NEXT_PUBLIC_SSO_ENABLED: "true"
  # NextAuth URL (public, non-sensitive)
  NEXTAUTH_URL: "https://caipe-ui.your-domain.com"  # Replace with your domain
  # Node environment
  NODE_ENV: "production"

# Example secret store paths for different providers:
#
# Vault:
#   key: "dev/caipe-ui"  # KV path in Vault
#
# AWS Secrets Manager:
#   key: "dev/caipe-ui"  # Secret name in AWS
#
# GCP Secret Manager:
#   key: "projects/PROJECT_ID/secrets/caipe-ui/versions/latest"
#
# Azure Key Vault:
#   key: "caipe-ui-secrets"  # Key Vault secret name
