nameOverride: ""
fullnameOverride: "rag-server"

# Feature Flags
enableGraphRag: true              # ENABLE_GRAPH_RAG - enable/disable graph RAG features
enableMcp: true                   # ENABLE_MCP - enable/disable MCP tools for AI agents
skipInitTests: false              # SKIP_INIT_TESTS - skip connection tests on startup

# Embeddings Configuration
embeddingsProvider: "azure-openai"  # EMBEDDINGS_PROVIDER - azure-openai or openai
embeddingsModel: "text-embedding-3-small"  # EMBEDDINGS_MODEL - model name

# Performance & Limits
maxDocumentsPerIngest: 1000       # MAX_DOCUMENTS_PER_INGEST - max documents per ingestion request
maxResultsPerQuery: 100           # MAX_RESULTS_PER_QUERY - max results per query
maxIngestionConcurrency: 30       # MAX_INGESTION_CONCURRENCY - max concurrent tasks during ingestion
maxGraphRawQueryResults: 100      # MAX_GRAPH_RAW_QUERY_RESULTS - max results for raw graph queries
maxGraphRawQueryTokens: 80000     # MAX_GRAPH_RAW_QUERY_TOKENS - max tokens in raw query results before truncation
searchResultTruncateLength: 500   # SEARCH_RESULT_TRUNCATE_LENGTH - truncate search results to N characters (for MCP tools)

# Other Settings
logLevel: INFO                    # LOG_LEVEL - logging level (DEBUG, INFO, WARNING, ERROR)
uiUrl: "http://localhost:9447"    # UI_URL - WebUI URL for health check response
sleepOnInitFailureSeconds: 180    # SLEEP_ON_INIT_FAILURE_SECONDS - sleep duration on init failure before shutdown
cleanupInterval: 86400            # CLEANUP_INTERVAL - cleanup interval for stale data (24 hours)

# RBAC/Authentication Configuration
# Configure when using OAuth2 Proxy for authentication
# Server enforces RBAC based on headers passed from OAuth2 Proxy (X-Forwarded-Groups)
rbac:
  allowUnauthenticated: true        # ALLOW_UNAUTHENTICATED - allow access without authentication
  readonlyGroups: ""                # RBAC_READONLY_GROUPS - comma-separated group names with read-only access
  ingestonlyGroups: ""              # RBAC_INGESTONLY_GROUPS - comma-separated group names with ingest-only access
  adminGroups: ""                   # RBAC_ADMIN_GROUPS - comma-separated group names with admin access
  defaultRole: "readonly"           # RBAC_DEFAULT_ROLE - default role when user doesn't match any group

image:
  # Prefer the prebuilt image; if building in-cluster is needed, adjust CI
  repository: "ghcr.io/cnoe-io/caipe-rag-server"
  # tag defaults to .Chart.AppVersion when not specified
  tag: ""
  pullPolicy: IfNotPresent

replicaCount: 1

# This sets the number of old ReplicaSets to retain for rollback
# Kubernetes will automatically clean up ReplicaSets beyond this limit
revisionHistoryLimit: 3

# Web Ingestor configuration (runs as sidecar container)
webIngestor:
  enabled: true
  image:
    repository: "ghcr.io/cnoe-io/caipe-rag-ingestors"
    # tag defaults to .Chart.AppVersion when not specified
    tag: ""
    pullPolicy: IfNotPresent

  # Ingestor settings
  logLevel: INFO
  maxConcurrency: 10              # WEBLOADER_MAX_CONCURRENCY - max concurrent HTTP requests per ingestion
  maxIngestionTasks: 5            # WEBLOADER_MAX_INGESTION_TASKS - max concurrent ingestion tasks
  reloadInterval: 86400           # WEBLOADER_RELOAD_INTERVAL - auto-reload interval in seconds (24 hours)

  # Resource limits for the web ingestor sidecar
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
      ephemeral-storage: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi
      ephemeral-storage: 1Gi

serviceAccount:
  create: false
  name: ""
  automount: false
  annotations: {}

service:
  type: ClusterIP
  port: 9446

resources: {}

nodeSelector: {}

tolerations: []

affinity: {}

podAnnotations: {}
podLabels: {}

imagePullSecrets: []

env: {}

llmSecrets:
  secretName: "llm-secret"

livenessProbe: {}
readinessProbe: {}
