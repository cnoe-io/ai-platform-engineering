CVE-2021-21972 VULNERABILITY DESCRIPTION
¶
CVE-2021-21972 identifies a Remote Code Execution (RCE) vulnerability for vCenter Servers
The RCE can be exploited by any user with access to port 443 on a vulnerable server
The affected plugin is installed by default for all vulnerable servers
Proof-of-Concept exploit code has been publicly released
CVE-2021-21972 MITIGATION STEPS (On Linux-based virtual appliances)
¶
SSH to the vCenter Appliance
ssh
-o
PubkeyAuthentication
=
no
root@10.60.17.11
Take a backup of file /etc/vmware/vsphere-ui/compatibility-matrix.xml :
cd
/etc/vmware/vsphere-ui/
cp
compatibility-matrix.xml
bckp-compatibility-matrix.xml
Open the file compatibility-matrix.xml
nano
/etc/vmware/vsphere-ui/compatibility-matrix.xml
Insert the line below into the file:
<PluginPackage
id
=
"com.vmware.vrops.install"
status
=
"incompatible"
/>
The compatibility-matrix.xml file should look like this:
Now we have to stop & restart the vsphere-ui service using the commands below:
service-control
--stop
vsphere-ui
service-control
--start
vsphere-ui
To check & confirm that the plugin is disabled we need to:
Navigate to
http://10.60.17.11/ui/vropspluginui/rest/services/checkmobregister
. The page displays a 404 Not Found error.
Connect to the vSphere Client interface:
https://pirl-vcenter.cisco.com/ui/
, under Menu/Administration/Solutions/Client Plug-ins to see VMware vRops Client Plugin state as Incompatible, confirming the endpoint /ui/vropspluginui is disabled.
2022-04-20