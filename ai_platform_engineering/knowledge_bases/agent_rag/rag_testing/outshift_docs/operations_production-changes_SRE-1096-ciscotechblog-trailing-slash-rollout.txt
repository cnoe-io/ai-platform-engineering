SRE-1096 (1): ciscotechblog.com trailing slash fix roll-out
¶
SRE-1096 (1): ciscotechblog.com trailing slash fix roll-out
Preparation Steps
Execute Change
Post-Validation
Roll-Back
Preparation Steps
¶
Update the
Ingress manifest template
in the application's Helm Chart to include the front-end domain (configured via the
frontendDomain
parameter) in its tls host and ingress rules lists.
Update the application's
deployment repo
with the appropriate environment-specific
frontendDomain
value (e.g., staging.ciscotechblog.com for the staging environment)
Merge:
https://wwwin-github.cisco.com/eti/techblog-website-deployment/pull/14
Verify new certificates with the front-end domain have been installed in the origins
Create a PR(
do NOT merge yet
) to disable "Green" deployments to ensure there is always only one active version ("blue") of the app
https://wwwin-github.cisco.com/eti/techblog-website-deployment/pull/15
Execute Change
¶
Ensure that
CloudFront's origins
are pointed at the "Blue" version's service (i.e., pointing at techblog-
blue
-a.prod.ciscotechblog.com and techblog-
blue
-b.prod.ciscotechblog.com)
Disable the
production deploy job
to prevent app from pointing back to Green
Merge the PRs created in
Preparation Steps
steps
Sync the app in ArgoCD to roll out green disablement changes above
Update
CloudFront Behaviors
to enable
Host
header forwarding
Post-Validation
¶
Open browser and enter:
https://ciscotechblog.com/blog/introducing-media-streaming-mesh
Verify that browser redirects to
https://ciscotechblog.com/blog/introducing-media-streaming-mesh/
Re-enable the
production deploy job
Roll-Back
¶
If the
https://ciscotechblog.com
page fails to load after the change, immediately roll back the Host header forwarding change in
CloudFront
*
*
2023-10-16