CWPP
oncall
system-tests
SystemTestsMetrics Is Below the Threshold
¶
SystemTestsMetrics Is Below the Threshold
Symptoms
Summary
Resolution 1
Resolution 2
Symptoms
¶
Example Alert:
[FIRING:1] custom/systemTestsMetrics for gcp-etigcp-nprd-12855 is below the threshold of 300.000. | Violation started: Sep 21, 2023 at 10:09PM UTC (less than 1 sec ago) | Policy: system tests metrics | Condition: custom/systemTestsMetrics [COUNT] | View incident:
https://console.cloud.google.com/monitoring/alerting/incidents/0.n2h6fws5sbuz?project=gcp-etigcp-nprd-12855
Tip
This will most likely happen in cases where there was a Jenkins instance/nodes upgrade/shutdown or a pipeline configuration change.
Summary
¶
The CWPP
periodic system tests pipeline
results are below the threshold of 300.000. (i.e. the system tests are either failing drastically OR the pipeline is not running properly)
Tip
If you require more context/information on the CWPP system tests, please refer to the
CWPP System Tests
documentation.
Resolution 1
¶
Check that the
periodic system tests pipeline
is actually being triggered and running properly.
If not running, check the
pipeline logs
for errors.
Trigger the pipeline manually and check the
pipeline logs
for errors.
Resolution 2
¶
Check that the
system tests listener pipeline
is running and triggering the
periodic system tests pipeline
If it had not run in the past hour, trigger it manually and check the
pipeline logs
for errors.
Note
If you notice that this pipeline is failing, make sure to check the logs. In most cases you will see the following error:
26-Sep [12:00:07.329]  java.lang.Exception: Job k8sec/mgmt-daytime-tests/master currently running, pipeline [mgmt-daytime-tests] already triggered
26-Sep [12:00:07.329]   at WorkflowScript.checkStatus4AllPipelines(WorkflowScript:15)
26-Sep [12:00:07.329]   at com.cloudbees.groovy.cps.CpsDefaultGroovyMethods.each(CpsDefaultGroovyMethods:2030)
26-Sep [12:00:07.329]   at com.cloudbees.groovy.cps.CpsDefaultGroovyMethods.each(CpsDefaultGroovyMethods:1890)
26-Sep [12:00:07.329]   at WorkflowScript.checkStatus4AllPipelines(WorkflowScript:7)
26-Sep [12:00:07.329]   at WorkflowScript.run(WorkflowScript:34)
26-Sep [12:00:07.329]   at ___cps.transform___(Native Method)
26-Sep [12:00:07.329]   at java.base/jdk.internal.reflect.GeneratedConstructorAccessor1584.newInstance(Unknown Source)
26-Sep [12:00:07.329]   at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
26-Sep [12:00:07.329]   at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
26-Sep [12:00:07.329]   at org.codehaus.groovy.reflection.CachedConstructor.invoke(CachedConstructor.java:83)
26-Sep [12:00:07.329]   at org.codehaus.groovy.reflection.CachedConstructor.doConstructorInvoke(CachedConstructor.java:77)
26-Sep [12:00:07.329]   at org.codehaus.groovy.runtime.callsite.ConstructorSite$ConstructorSiteNoUnwrap.callConstructor(ConstructorSite.java:84)
This is considered an expected error, as it shows that the
periodic system tests pipeline
is properly running.
Note
Make sure to always keep the CWPP team updated in the
CWPP Alerts
webex space, it is also where you should post in case you need assitance with the issue. Another good space to communicate in is the
SRE for Panoptica(CWPP)
2024-02-25