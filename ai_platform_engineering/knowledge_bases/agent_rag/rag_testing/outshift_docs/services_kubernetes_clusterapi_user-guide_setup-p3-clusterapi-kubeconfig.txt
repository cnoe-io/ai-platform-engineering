kubernetes access
p3 kubernetes
Setup P3 clusterapi kube config
¶
Pre-requisites
¶
kubectl
krew
Step 1: Install Konfig
¶
Reference
kubectl
krew
install
konfig
Step 2: Setup P3 Cluster kubeconfig
¶
Note:
Pick the cluster name from
here
Vault login and copy token
export
VAULT_TOKEN
=
<YOUR
VAULT
TOKEN>
export
CLUSTERAPI_CLUSTER
=
<ADD
YOUR
CLUSTER
NAME
HERE>
Copy and run the following:
export VAULT_NAMESPACE=eticloud/teamsecrets
export VAULT_ADDR=https://keeper.cisco.com
vault kv get -field=kubeconfig-b64 secret/p3/${CLUSTERAPI_CLUSTER} | base64 -d > /tmp/${CLUSTERAPI_CLUSTER}
kubectl konfig import -s /tmp/${CLUSTERAPI_CLUSTER}
rm /tmp/${CLUSTERAPI_CLUSTER}
kubectl config use-context ${CLUSTERAPI_CLUSTER}
The above script will fetch the necessary secrets from Vault stored here
teamsecrets
Step 3: Verify kubectl access
¶
kubectl
cluster-info
kubectl
get
pods
-A
2023-12-06