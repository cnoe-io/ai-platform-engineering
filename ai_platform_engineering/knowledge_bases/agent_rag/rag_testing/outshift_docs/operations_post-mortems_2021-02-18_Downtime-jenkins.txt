Post mortem from last downtime on Jenkins infra
¶
When:
2021-02-18
Authors:
SRE team
Summary:
Upgrade required on the Jenkins agent infra for running image scan causes build infra downtime / changes.
Adding new Jenkins nodes into production builds, without proper canary tests, caused builds to fails intermittently on nodes that have docker daemon issues.
ETI SRE Monitoring server hostname was change without prior notice
Impact(s):
Monitoring service was down for few hours
Ventures builds intermittent failure
Configuration changes so venture can not ssh to new agent
SRE team delayed deliverables to AppNet
Trigger:
automation / infra upgrade
new ssh configuration on nodes
Detection:
Ventures raised issues on build / ssh failure
PG alerts on nodes down
Resolution(s):
Sri restore ssh keys on new WCM nodes + enable old agent in new monitoring system
Jeremie update new infra to keep consistency on monitoring service
Come-up with a plan to provide temporary access to Jenkins nodes for self-service
Timeline:
02-18 08:00 UTC - SRE team added new Jenkins nodes to ETI Jenkins Infrastructure
02-18 18:56 UTC - AppNet reported build failures and engaged SRE team member
02-18 19:30 UTC - SRE team member root caused the issue to be new Jenkins nodes and AppNet team member unable to self-service due to changed SSH keys
02-18 20.09 UTC - SRE team member helped AppNet team with immediate need of cleaning up the workspace and resolved the issue 02-18 20.09 UTC
Analysis
¶
Problem
¶
New Jenkins infra
Ventures not alerted by this major change
Cause
¶
New infra / automation required on a new Runon OpenStack project for performing image scan.
Tactical fixes
¶
New jenkins infra
Sri had to update the new agent with the same ssh configuration on the new nodes based on old node configuration.
Sri update the monitoring playbook / inventory in order to manage older nodes
Jeremie update the Terraform / Ansible to keep monitoring service consistency
Ventures not alerted by this major changes
Missing email communication on upcoming changes with dates of downtime
Actions items
¶
SRE team to improve the canary deployment of agents in order to prevent service downtime & rollback strategy
SRE team to communicate on any upcoming platform changes with dates / details on services changes / downtime (if any)
SRE team to put canary testing with ventures for infra changes validation
2022-05-05