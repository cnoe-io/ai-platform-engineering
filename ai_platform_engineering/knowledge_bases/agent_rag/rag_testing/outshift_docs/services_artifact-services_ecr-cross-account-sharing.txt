ecr cross account sharing setup
ECR Cross Account Sharing Setup
¶
Create a repository policy
¶
Open the Amazon ECR console for your primary account.
In the navigation pane, under Private registry, choose Repositories.
Choose the repository that you want to modify.
In the navigation pane, choose Permissions.
Choose Edit policy JSON.
Enter your policy into the code editor, and then choose Save.
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "AllowPull",
"Effect": "Allow",
"Principal": {
"AWS": "arn:aws:iam::961088030672:root"
},
"Action": [
"ecr:BatchCheckLayerAvailability",
"ecr:BatchGetImage",
"ecr:GetDownloadUrlForLayer"
]
}
]
}
Verify in the secondary account
¶
Run get-login-password command to generate a Docker authentication token for the cross-account
aws ecr get-login-password --region regionID | docker login --username AWS --password-stdin aws_account_id.dkr.ecr.regionID.amazonaws.com
Verify by listing images
docker images | grep ImageName
References
¶
https://repost.aws/knowledge-center/secondary-account-access-ecr
2024-08-18