CVE-1999-0508 - NetApp vulnerability
¶
In Paris Lab, there is a NetApp on instance 10.60.6.8, 10.60.6.9 and 10.60.6.10.
Infosec did identify this vulnerability:
One or more valid SSH user logins have been found through bruteforcing.
An account on a router, firewall, or other network device has a default, null, blank, or missing password.(CVE-1999-0508)
A Unix account has a default, null, blank, or missing password.(CVE-1999-0502)
Juniper ScreenOS 6.3.0r17 through 6.3.0r20 allows remote attackers to obtain administrative access by entering an unspecified password during a (1) SSH or (2) TELNET session.(CVE-2015-7755)
QID flags if the SSH layer on the target accepts authentication with a particular username/password combination. Note that this does not imply that a particular access level exists on the target for that user, that the username/password exists in any table on the target, or that there is shell access or anything else of that kind for that user.
This is vulnerable because SSH bruteforcing can only address the authentication layer of SSH. After authentication additional SSH protocol layers can be accessed in different forms, but we have no way of enumerating and testing all those channel and request types, especially not vendor-specific ones. The SSH protocol is designed to perform authentication at the authentication layer, and not inside some channel later.
Any SSH server that violates that design principle by allowing SSH-level authentication with guessable credentials should be considered vulnerable, regardless of what channels or requests are observable from the outside.
Seeing the QID reported simply means that the SSH layer did not reject the provided username/password, and instead advanced the SSH connections to the point where "sessions" could be established.
NOTE:
In the results section '/' means no username and no password was used for authentication or none authentication, which allow empty passwords or without a password to log in with no authentication through the console
"none authentication" simply means that the target does not request authentication in the SSH session, so it allows access without a password.
IMPACT:
Exploitation of this vulnerability may lead to a complete compromise of the host.
On successful exploitation it allows remote attackers to obtain administrative access by entering an unspecified password during a (1) SSH or (2) TELNET session
Basically, you can ssh with root/admin but even if the NetApp close directly the ssh session, this is considered as a vulnerability.
Applying fix
¶
In order to keep the service running within Paris lab, we did apply an ACL configuration in the PIRL GW such as:
JEGARNIE-M-80KX:sre-labs
jegarnie$
ssh
-oKexAlgorithms
=
+diffie-hellman-group-exchange-sha1
-c
aes256-cbc
admin@10.60.6.254
Password:
###################################################
#     Paris Innovation & Research Lab - PIRL      #
#                 PIRL-CORP-TS                    #
###################################################
You
are
connected
to
line
388
at
router
PIRL-CORP-TS
PIRL-CORP-TS#show
ip
access-lists
Extended
IP
access
list
100
10
permit
tcp
host
0
.0.0.0
any
eq
8080
PIRL-CORP-TS#conf
t
Enter
configuration
commands,
one
per
line.
End
with
CNTL/Z.
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.8 eq 22
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.8 eq 23
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.9 eq 22
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.9 eq 23
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.10 eq 22
PIRL-CORP-TS
(
config
)
#access-list 102 deny tcp any host 10.60.6.10 eq 23
PIRL-CORP-TS
(
config
)
#access-list 102 permit ip any any
PIRL-CORP-TS
(
config
)
#int g0/0
PIRL-CORP-TS
(
config-if
)
#ip access
PIRL-CORP-TS
(
config-if
)
#ip access-group 102 in
PIRL-CORP-TS
(
config-if
)
#end
PIRL-CORP-TS#copy
running-config
startup-config
PIRL-CORP-TS#show
access-lists
Extended
IP
access
list
100
10
permit
tcp
host
0
.0.0.0
any
eq
8080
Extended
IP
access
list
102
10
deny
tcp
any
host
10
.60.6.8
eq
22
(
8
matches
)
20
deny
tcp
any
host
10
.60.6.8
eq
telnet
30
deny
tcp
any
host
10
.60.6.9
eq
22
(
11
matches
)
40
deny
tcp
any
host
10
.60.6.9
eq
telnet
50
deny
tcp
any
host
10
.60.6.10
eq
22
(
3
matches
)
60
deny
tcp
any
host
10
.60.6.10
eq
telnet
70
permit
ip
any
any
(
38793
matches
)
2022-04-20