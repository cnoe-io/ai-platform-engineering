Break-Glass
DB Access
PgAdmin
RDS
Break-glass solution for accessing PostgreSQL
¶
Purpose
¶
This document provides a break-glass solution for accessing PostgreSQL databases in case the primary method of access is not available. It is meant for read-only access to the database and should not be used for any write operations. While the solution is targeted to be as secure as possible, it is not recommended to use this method to do any development operations on the database in production.
Pre-requisites
¶
You have an RDS instance running
Your EKS cluster has the new
pgadmin4
baseapp installed and configured by the SRE team
[Optional] You have setup a DB user with necessary permissions to the database
You have been added to the relevant AD group to access the
pgadmin4
baseapp for your cluster (
<project name>-pgadmin4-access
)
Komodor is installed in your cluster and setup for integration with the
pgadmin4
baseapp by the SRE team
You have installed the Komodor CLI on your local machine
Steps
¶
Login to Komodor using the URL provided by the SRE team:
https://app.komodor.com
. You will see a prompt to login with your Cisco credentials using SSO.
Once you have logged in, you will see the
Komodor
dashboard. Click on the
Workloads -> Pods
tab on the left-hand side.
At the top you will see a selection box for cluster and namespace. Select the relevant cluster and namespace where the
pgadmin4
baseapp is installed.
Once the right cluster and namespace are selected, you should be able to see the list of pods running in the namespace. Look for the pod with the name
<cluster name>-pgadmin4-<project name>-<identifier>
and click on the
Actions
drop down on the right hand side.
Click on the
Port Forward
option from the drop down. This will open a popup with all the necessary instructions for running port-forwarding to access the
pgadmin4
baseapp.
Warning
Make sure to change the port number in the command to
9003
(as shown in the above screen shot) otherwise you will not be able to access the
pgadmin4
baseapp/login.
Note
It is curcial to download/install the Komodor CLI as described in the popup. The CLI is required to run the port-forwarding command.
Open a terminal on your local machine and run the port-forwarding command provided in the popup. This will create a tunnel between your local machine and the
pgadmin4
baseapp running in the EKS cluster.
Open the
pgadmin4
baseapp by navigating to the URL provided by the above command. You will see a prompt to login with your Cisco credentials using SSO.
Once you have logged in, you will see the
pgadmin4
dashboard. Click on the upper
Servers
tab on the left-hand side.
Once the
Servers
tab is selected, you should be able to see the list of servers/databases that you have access to.
Note
Please note that the
pgadmin4
baseapp in
PROD
is for read-only access to the database. Dev/Staging environments currently allow for write operations. If you need to perform any write operations on a
PROD
environment, please reach out to the SRE team for assistance.
You may now navigate to the database you want to access and click on it to view the tables and data or run any queries you might require.
Warning
The login has a timeout of 1 hour. If you are logged out, you will need to re-login using SSO. Any running queries will keep you logged in until they are completed, at which point you will be logged out.
2024-10-15