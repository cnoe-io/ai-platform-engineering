CWPP
add cluster
demo.panoptica.app
How-to add a cluster to demo.panoptica.app
¶
This runbook walk thru step-by-step guide on how to add a cluster with sock shop to demo.panoptica.app
Reference:
SRE-4442
Summary
¶
K8s cluster like GKE
Minimum requirements: 3 node cluster with 4 CPU and 16GB per node.
Install sock shop
Create Panoptica test instance
Add cluster to test instance using a python script
Verify cluster in test instance
Add cluster to production demo instance using a python script
Verify cluster in production demo instance
Step 1: Create a self-service GKE cluster.
¶
GKE Cluster Provision Job
Wait for webex notification that confirm GKE cluster has been created.
Verify kubectl access
gcloud container clusters get-credentials demo-sock-shop-cluster --zone us-central1-a --project gcp-etigcp-nprd-12855
kubectl get pods -A
Step 2: Install sock shop
¶
git clone https://github.com/microservices-demo/microservices-demo
cd microservices-demo/deploy/kubernetes/
kubectl apply -f complete-demo.yaml
Step 3: Create Panoptica demo instance
¶
Run Jenkins Job with params
Login to
sraradhy.demo.panoptica.app
Step 4: Add cluster to test instance using a python script
¶
Python script
python3 attach_k8s_cluster_via_helm.py --name demo-sock-shop-cluster --url sraradhy.demo.panoptica.app
Add cluster to Panoptica backend.
Install Istio, Vault and Panoptica agent using helm charts.
Step 5: Verify cluster in test instance
¶
Login to
sraradhy.demo.panoptica.app
Verify UI deployments
Step 6: Add cluster to production demo instance using a python script
¶
Python script
python3 attach_k8s_cluster_via_helm.py --name demo-sock-shop-cluster --url demo.panoptica.app
Add cluster to Panoptica backend.
Install Istio, Vault and Panoptica agent using helm charts.
Step 7: Verify cluster in production demo instance
¶
Login to
demo.panoptica.app
Verify UI deployments
2024-02-25