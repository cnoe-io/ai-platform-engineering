# üöÄ Slack AI Agent

[![Python](https://img.shields.io/badge/python-3.13%2B-blue?logo=python)](https://www.python.org/)
[![Poetry](https://img.shields.io/badge/poetry-2.1.1%2B-blueviolet?logo=python)](https://python-poetry.org/)
[![License](https://img.shields.io/badge/license-Apache%202.0-green)](LICENSE)

[![Conventional Commits](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/conventional_commits.yml/badge.svg)](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/conventional_commits.yml)
[![Ruff Linter](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/ruff.yml/badge.svg)](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/ruff.yml)
[![Super Linter](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/superlinter.yml/badge.svg)](https://github.com/cnoe-io/openapi-mcp-codegen/actions/workflows/superlinter.yml)
[![Unit Tests](https://github.com/cnoe-io/agent-slack/actions/workflows/unit-tests.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/unit-tests.yml)

[![A2A Docker Build and Push](https://github.com/cnoe-io/agent-slack/actions/workflows/a2a-docker-build.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/a2a-docker-build.yml)
---

## üß™ Evaluation Badges

| Claude | Gemini | OpenAI | Llama |
|--------|--------|--------|-------|
| [![Claude Evals](https://github.com/cnoe-io/agent-slack/actions/workflows/claude-evals.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/claude-evals.yml) | [![Gemini Evals](https://github.com/cnoe-io/agent-slack/actions/workflows/gemini-evals.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/gemini-evals.yml) | [![OpenAI Evals](https://github.com/cnoe-io/agent-slack/actions/workflows/openai-evals.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/openai-evals.yml) | [![Llama Evals](https://github.com/cnoe-io/agent-slack/actions/workflows/openai-evals.yml/badge.svg)](https://github.com/cnoe-io/agent-slack/actions/workflows/openai-evals.yml) |

---

- ü§ñ **Slack Agent** is an LLM-powered agent built using the [LangGraph ReAct Agent](https://langchain-ai.github.io/langgraph/agents/agents/) workflow and [MCP tools](https://modelcontextprotocol.io/introduction).
- üåê **Protocol Support:** Compatible with [ACP](https://github.com/agntcy/acp-spec) and [A2A](https://github.com/google/A2A) protocols for integration with external user clients.
- üõ°Ô∏è **Secure by Design:** Enforces Slack API token-based authentication and supports external authentication for strong access control.
- üîå **Integrated Communication:** Uses [langchain-mcp-adapters](https://github.com/langchain-ai/langchain-mcp-adapters) to connect with the Slack MCP server within the LangGraph ReAct Agent workflow.
- üè≠ **First-Party MCP Server:** The MCP server is generated by our first-party [openapi-mcp-codegen](https://github.com/cnoe-io/openapi-mcp-codegen/tree/main) utility, ensuring version/API compatibility and software supply chain integrity.

---

## üèóÔ∏è Architecture

```mermaid
flowchart TD
  subgraph Client Layer
    A[User Client ACP/A2A]
  end

  subgraph Agent Transport Layer
    B[AGNTCY ACP<br/>or<br/>Google A2A]
  end

  subgraph Agent Graph Layer
    C[LangGraph ReAct Agent]
  end

  subgraph Tools/MCP Layer
    D[LangGraph MCP Adapter]
    E[Slack MCP Server]
    F[Slack API Server]
  end

  A --> B --> C
  C --> D
  D -.-> C
  D --> E --> F --> E
```

## ‚ú® Features

- ü§ñ **LangGraph + LangChain MCP Adapter** for agent orchestration
- üß† **Azure OpenAI GPT-4** as the LLM backend
- üîó Connects to Slack via a dedicated [Slack MCP agent](https://github.com/cnoe-io/agent-slack/tree/main/agent_slack/protocol_bindings/mcp_server)
- üîÑ **Multi-protocol support:** Compatible with both **ACP** and **A2A** protocols for flexible integration and multi-agent orchestration
- üìä **Comprehensive Slack API Support:**
  - Channel Management (list, join, leave)
  - Message Management (send, update, delete)
  - User Management (list, info, status)
  - File Management (upload, list, delete)
  - Reaction Management (add, remove)
  - Thread Management (reply, follow)

---

## üöÄ Getting Started

Running it via Docker:

### 1Ô∏è‚É£ Configure Environment
Ensure your `.env` file is set up as described in the [cnoe-agent-utils usage guide](https://github.com/cnoe-io/cnoe-agent-utils) based on your LLM Provider.

#### Setting Up Slack Environment Variables

1. **Create a Slack App:**
   - Go to [Slack API](https://api.slack.com/apps)
   - Click "Create New App"
   - Choose "From scratch"
   - Enter a name and select your workspace
   - Click "Create App"

2. **Configure Bot Permissions:**
   - In your app dashboard, go to "OAuth & Permissions"
   - Under "Scopes", add the following Bot Token Scopes:
     - `app_mentions:read`
     - `channels:history`
     - `chat:write`
     - `users:read`
     - `groups:history`
     - `im:history`
     - `mpim:history`

3. **Install the App:**
   - Go to "Install App" tab
   - Click "Install to Workspace"
   - Copy your Bot Token (starts with `xoxb-`) - This will be your `SLACK_BOT_TOKEN`

4. **Get Other Slack Credentials:**
   - Go to "Basic Information" in your app settings
   - Find and copy:
     - App ID
     - Client ID
     - Client Secret (`SLACK_CLIENT_SECRET`)
     - Signing Secret (`SLACK_SIGNING_SECRET`)
     - Team ID (`SLACK_TEAM_ID`)

5. **Enable Socket Mode:**
   - Go to "Socket Mode" in your app settings
   - Enable Socket Mode
   - Generate an app-level token (starts with `xapp-`) - This will be your `SLACK_APP_TOKEN`

#### Setting Up Azure OpenAI Environment Variables

1. **Get Azure OpenAI Credentials:**
   - Go to [Azure Portal](https://portal.azure.com)
   - Navigate to your Azure OpenAI resource
   - Under "Resource Management" > "Keys and Endpoint"
   - Copy:
     - Key 1 or Key 2 (`AZURE_OPENAI_API_KEY`)
     - Endpoint URL (`AZURE_OPENAI_ENDPOINT`)
   - Note your deployment name (`AZURE_OPENAI_DEPLOYMENT`)

#### Port Configuration
The agent runs on port 8000 by default. If this port is occupied, you can modify it in your `.env` file:
```env
A2A_AGENT_PORT=8000  # Change to any available port
```

Example `.env` configuration:
```env
############################
# Agent Configuration
############################
LLM_PROVIDER=azure-openai
AGENT_NAME=Slack

## A2A Agent Configuration
A2A_AGENT_HOST=localhost
A2A_AGENT_PORT=8000  # Change if port 8000 is occupied

## MCP Server Configuration
MCP_HOST=localhost
MCP_PORT=9000

############################
# Azure OpenAI Configuration
############################
AZURE_OPENAI_API_KEY=<your-azure-key>        # From Azure Portal > Keys and Endpoint
AZURE_OPENAI_API_VERSION=2025-04-01-preview
AZURE_OPENAI_DEPLOYMENT=gpt-4.1              # Your deployment name from Azure
AZURE_OPENAI_ENDPOINT=<your-azure-endpoint>  # From Azure Portal > Keys and Endpoint

############################
# Slack Configuration
############################
SLACK_BOT_TOKEN=<your-bot-token>             # From OAuth & Permissions > Bot User OAuth Token
SLACK_APP_TOKEN=<your-app-token>             # From Socket Mode > App-Level Token
SLACK_SIGNING_SECRET=<your-signing-secret>   # From Basic Information > App Credentials
SLACK_CLIENT_SECRET=<your-client-secret>     # From Basic Information > App Credentials
SLACK_TEAM_ID=<your-team-id>                 # From Basic Information > App Credentials
```

### 2Ô∏è‚É£ Start the Agent (A2A Mode)
1. Pull the A2A image:
```bash
docker pull ghcr.io/cnoe-io/agent-slack:a2a-v0.1.1
```

2. Run the agent in a Docker container using your `.env` file:
```bash
docker run -it --rm \
  --env-file .env \
  -p 8000:8000 \
  ghcr.io/cnoe-io/agent-slack:a2a-v0.1.1
```

### 3Ô∏è‚É£ Run the Client
First, set up a virtual environment and install required tools:

#### Set Up Virtual Environment

**For Linux/macOS:**
```bash
# Create virtual environment
python -m venv .venv

# Activate virtual environment
source .venv/bin/activate
```

**For Windows:**
```bash
# Create virtual environment
python -m venv .venv

# Activate virtual environment
.\.venv\Scripts\activate
```

#### Install uv
```bash
# Install uv package manager
pip install uv
```

Now you can use the [agent-chat-cli](https://github.com/cnoe-io/agent-chat-cli) to interact with the agent:

```bash
uvx https://github.com/cnoe-io/agent-chat-cli.git a2a
```

### Alternative: Running Locally
You can also run the agent locally without Docker:

First clone the repo

```bash
git clone https://github.com/cnoe-io/agent-slack.git
cd agent-slack
```

```bash
make run-a2a
```

In a new terminal, start the A2A client:
```bash
make run-a2a-client
```

### Alternative: ACP Mode (Legacy)
If you need to use ACP mode instead:

1. Run the agent:
```bash
make run-acp
```

2. In a new terminal, start the ACP client:
```bash
make run-acp-client
```

## Quick Demos

### ‚ñ∂Ô∏è Test with Slack API


### Example Interactions

1. **Channel Management**
```
User: list all channels
Agent: Here are all the channels in the workspace:

1. #general - Company-wide announcements
   - Members: 150
   - Purpose: General discussion and updates

2. #dev-team - Development team discussions
   - Members: 45
   - Purpose: Technical discussions and updates

3. #random - Random conversations
   - Members: 120
   - Purpose: Non-work related chats

Would you like to join any of these channels or get more details?
```

2. **Message Management**
```
User: send a message to #general
Agent: I'll help you send a message. What would you like the message to say?

User: Hello team! Just testing our new Slack bot.
Agent: I'll send that message to #general. Here's what I'm going to send:

"Hello team! Just testing our new Slack bot."

Would you like me to:
1. Send it as is
2. Add formatting or emojis
3. Make any changes first?

User: Send it as is
Agent: Message sent successfully to #general! 
Message ID: 1234567890.123456
Timestamp: 2024-04-10 14:30:00 UTC

Let me know if you'd like to:
- Add reactions to the message
- Start a thread
- Edit or delete the message
```

## üîç Troubleshooting

### Common Issues

1. **Slack API Issues**
   - Verify bot token scopes are correct
   - Check if app is properly installed to workspace
   - Ensure Socket Mode is enabled if required

2. **Port Conflicts**
   - If port 8000 is in use, modify port in `.env`
   - Check for other services using required ports

3. **Environment Variables**
   - Verify all required variables in `.env`
   - Check API keys and tokens are valid
   - No trailing spaces in values

4. **Client Connection Issues**
   - Server must be running before client
   - Port numbers should match
   - API keys must match between server and client

## üìö Documentation

For more detailed information about the project, please refer to:

- [API Documentation](docs/api.md) - Detailed API reference
- [Architecture Overview](docs/architecture.md) - System design and components
- [Development Guide](docs/development.md) - Setup and development workflow
- [Deployment Guide](docs/deployment.md) - Production deployment instructions
- [Contributing Guide](CONTRIBUTING.md) - How to contribute to the project
- [Security Policy](SECURITY.md) - Security practices and vulnerability reporting
- [License](LICENSE) - Project license details
- [Changelog](CHANGELOG.md) - Version history and changes
- [Code of Conduct](CODE_OF_CONDUCT.md) - Community guidelines

## üîê Security Notes

* Never commit your `.env` file to version control
* Keep your API keys and tokens secure
* Use environment variables or secret managers in production
* Regularly rotate your API keys and tokens

## üë• Maintainers

See [MAINTAINERS.md](MAINTAINERS.md) for the list of maintainers.

## ü§ù Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details on how to get started.

## üìÑ License

Apache 2.0 